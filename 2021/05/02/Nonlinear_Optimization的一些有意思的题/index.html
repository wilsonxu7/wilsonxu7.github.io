<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"8.0.0-rc.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":false,"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false};
  </script>

  <meta name="description" content="Nonlinear_Optimization 的一些有意思的题非线性优化这门课是在2019年秋季学期上的。使用matlab实现各种优化算法，其中涉及到： • Matlab programming  • math review • classical optimization methods  • unconstrained&#x2F;constrained optimization   • gradient">
<meta property="og:type" content="article">
<meta property="og:title" content="Nonlinear_Optimization的一些有意思的题">
<meta property="og:url" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/index.html">
<meta property="og:site_name" content="Wilson&#39;s Blog">
<meta property="og:description" content="Nonlinear_Optimization 的一些有意思的题非线性优化这门课是在2019年秋季学期上的。使用matlab实现各种优化算法，其中涉及到： • Matlab programming  • math review • classical optimization methods  • unconstrained&#x2F;constrained optimization   • gradient">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502141321603.png">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502141618290.png">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502142044132.png">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502142055172.png">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502144252350.png">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502154702292.png">
<meta property="og:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502150511302.png">
<meta property="article:published_time" content="2021-05-02T05:39:17.000Z">
<meta property="article:modified_time" content="2021-05-02T08:13:28.655Z">
<meta property="article:author" content="Wilson Xu">
<meta property="article:tag" content="course">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502141321603.png">

<link rel="canonical" href="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-cn'
  };
</script>

  <title>Nonlinear_Optimization的一些有意思的题 | Wilson's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="تشغيل شريط التصفح">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Wilson's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wilson Xu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wilson's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Nonlinear_Optimization的一些有意思的题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>
              

              <time title="أُنشأ: 2021-05-02 13:39:17 / عُدل: 16:13:28" itemprop="dateCreated datePublished" datetime="2021-05-02T13:39:17+08:00">2021-05-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Nonlinear-Optimization-的一些有意思的题"><a href="#Nonlinear-Optimization-的一些有意思的题" class="headerlink" title="Nonlinear_Optimization 的一些有意思的题"></a>Nonlinear_Optimization 的一些有意思的题</h1><p>非线性优化这门课是在2019年秋季学期上的。使用matlab实现各种优化算法，其中涉及到：</p>
<p>• Matlab programming </p>
<p>• math review • classical optimization methods </p>
<p>• unconstrained/constrained optimization  </p>
<p>• gradient-based/non-gradient optimization approaches </p>
<p>• recent advances in modeling and optimization research  relevant to electrical engineering </p>
<p>• knowledge based methods such as surrogate and Space  Mapping (SM) optimization </p>
<p>• global optimization approaches such as particle swarm  optimization (PSO)</p>
<p>使用matlab进行编程，难度不高，但也存在一些非常有意思的题目。在此分享题目与其对应解答。</p>
<h2 id="Exercise-Polynomial-Interpolation"><a href="#Exercise-Polynomial-Interpolation" class="headerlink" title="Exercise: Polynomial Interpolation"></a>Exercise: Polynomial Interpolation</h2><p>Write a Matlab function that finds a polynomial interpolating the data set {(xi,yi)},  i =1,…,n, finds all local minima and maxima of this polynomial and plots both the  polynomial, its first-order derivative, input data set as well as locations of the  minima/maxima.</p>
<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502141321603.png" class title="image-20210502141321603">

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">clear all;  close all;  clc;</span><br><span class="line">dataset=[<span class="number">0</span>,<span class="number">0</span>;<span class="number">2</span>,<span class="number">-1</span>;<span class="number">2.8</span>,<span class="number">5</span>;<span class="number">4</span>,<span class="number">2</span>;<span class="number">5</span>,<span class="number">-1</span>;<span class="number">6</span>,<span class="number">5</span>;<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">axis([<span class="number">0</span> <span class="number">7</span> <span class="number">-50</span> <span class="number">20</span>])</span><br><span class="line"><span class="built_in">hold</span> on;    grid on;</span><br><span class="line"></span><br><span class="line">x=dataset(:,<span class="number">1</span>);</span><br><span class="line">v=dataset(:,<span class="number">2</span>);</span><br><span class="line">P=polyfit(x,v,<span class="built_in">length</span>(x)<span class="number">-1</span>);</span><br><span class="line">dt = <span class="number">0.01</span>;</span><br><span class="line">xx = <span class="built_in">min</span>(x):dt:<span class="built_in">max</span>(x);</span><br><span class="line">yy = polyval(P,xx);</span><br><span class="line"><span class="built_in">plot</span>(xx,yy,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">% % 多项式插值结果</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(dataset(:,<span class="number">1</span>),dataset(:,<span class="number">2</span>),<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);        <span class="comment">%Data points</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>([<span class="number">0</span>,<span class="number">7</span>],[<span class="number">0</span>,<span class="number">0</span>],<span class="string">&#x27;r&#x27;</span>);      <span class="comment">%Zero level</span></span><br><span class="line"></span><br><span class="line">Y_diff=diff(yy)/dt;</span><br><span class="line"><span class="built_in">plot</span>(xx(<span class="number">1</span>:<span class="number">700</span>),Y_diff,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">1</span>);  <span class="comment">% First-order derivative of p</span></span><br><span class="line"></span><br><span class="line">index_max=<span class="built_in">intersect</span>(<span class="built_in">find</span>(diff(yy)&gt;<span class="number">0</span>)+<span class="number">1</span>,<span class="built_in">find</span>(diff(yy)&lt;<span class="number">0</span>));   <span class="comment">%找到极大值</span></span><br><span class="line">index_min=<span class="built_in">intersect</span>(<span class="built_in">find</span>(diff(yy)&lt;<span class="number">0</span>)+<span class="number">1</span>,<span class="built_in">find</span>(diff(yy)&gt;<span class="number">0</span>));   <span class="comment">%找到极小值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(xx(index_max),yy(index_max),<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;markersize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(xx(index_max),Y_diff(index_max));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(index_max)</span><br><span class="line">    line([xx(index_max(<span class="built_in">i</span>)),xx(index_max(<span class="built_in">i</span>))],[Y_diff(index_max(<span class="built_in">i</span>)),yy(index_max(<span class="built_in">i</span>))],<span class="string">&#x27;linestyle&#x27;</span>,<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span>         <span class="comment">%Locations of local maxima/minima</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(xx(index_min),yy(index_min),<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;markersize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(xx(index_min),Y_diff(index_min));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(index_min)</span><br><span class="line">    line([xx(index_min(<span class="built_in">i</span>)),xx(index_min(<span class="built_in">i</span>))],[Y_diff(index_min(<span class="built_in">i</span>)),yy(index_min(<span class="built_in">i</span>))],<span class="string">&#x27;linestyle&#x27;</span>,<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span>         <span class="comment">%Locations of local maxima/minima</span></span><br><span class="line">  <span class="built_in">plot</span>([<span class="number">0</span>,<span class="number">7</span>],[<span class="number">0</span>,<span class="number">0</span>],<span class="string">&#x27;r&#x27;</span>);      <span class="comment">%Zero level</span></span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;Interpolation polynomial p&#x27;</span>,<span class="string">&#x27;Data points&#x27;</span>,<span class="string">&#x27;Zero level&#x27;</span>,<span class="string">&#x27;First-order derivative of p&#x27;</span>,<span class="string">&#x27;Locations of local maxima/minima&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">hold</span> off;  </span><br></pre></td></tr></table></figure>



<h2 id="Exercise-Numerical-Methods-for-ODEs"><a href="#Exercise-Numerical-Methods-for-ODEs" class="headerlink" title="Exercise: Numerical Methods for ODEs"></a>Exercise: Numerical Methods for ODEs</h2><p>First-order ordinary differential equation can be written in the form of y’(t) = f(t,y(t))  with the initial condition y(t0) = y0. </p>
<p>Write Matlab functions that solve this equation using Euler’s method (yn+1 = yn +  h·f(tn,yn), where tn+1 = tn + h, and h is the method’s step) and Adams-Bashforth  method (yn+2 = yn+1 + 1.5·h·f(tn+1,yn+1) – 0.5·h·f(tn,yn), with tn and h as before). </p>
<p>Test your functions by solving two equations: y’(t) = -y + 3cos(3t)·exp(-t), y(0) = 0  (exact solution: y(t) = sin(3t)·exp(-t)), and y’(t) = y, y(0) = 1 (exact solution y(t) =  exp(t)). Plot the numerical and exact solutions for 0 ≤ t ≤ 5. Consider h = 0.2, 0.1,  0.05, and 0.01.</p>
<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502141618290.png" class title="image-20210502141618290">

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% main.m</span></span><br><span class="line">clear all;</span><br><span class="line">close all;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">a=<span class="number">0</span>;    b=<span class="number">5</span>;    y0=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">h_temp=[<span class="number">0.2</span>,<span class="number">0.1</span>,<span class="number">0.05</span>,<span class="number">0.01</span>];</span><br><span class="line">f=<span class="string">&#x27;fun&#x27;</span>;</span><br><span class="line">p=<span class="built_in">figure</span>;</span><br><span class="line">set(p,<span class="string">&#x27;position&#x27;</span>,[<span class="number">100</span> <span class="number">100</span> <span class="number">1000</span> <span class="number">600</span>]);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    h=h_temp(<span class="built_in">i</span>);</span><br><span class="line">    E=Euler(f,h,a,b,y0);</span><br><span class="line">    y1=E(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">    A=AdamBashforth(f,h,a,b,y0,y1);</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="built_in">i</span>);</span><br><span class="line"><span class="comment">%     axis([0 5 -0.4 1]);</span></span><br><span class="line">    <span class="built_in">hold</span> on;    grid on;</span><br><span class="line">    t=a:h:b;</span><br><span class="line">    y=<span class="built_in">exp</span>(t);</span><br><span class="line">    <span class="built_in">plot</span>(t,y,<span class="string">&#x27;b&#x27;</span>)       <span class="comment">%Exact solution</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">plot</span>(E(:,<span class="number">1</span>),E(:,<span class="number">2</span>),<span class="string">&#x27;-.&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;k&#x27;</span>);</span><br><span class="line">    <span class="comment">%Euler</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">plot</span>(A(:,<span class="number">1</span>),A(:,<span class="number">2</span>),<span class="string">&#x27;k&#x27;</span>);  <span class="comment">%AdamBashfort</span></span><br><span class="line">    <span class="built_in">hold</span> off;</span><br><span class="line">    <span class="built_in">legend</span>(<span class="string">&#x27;Exact solution&#x27;</span>,<span class="string">&#x27;Numerical solution (Euler)&#x27;</span>,<span class="string">&#x27;Numerical solution (Adams-Bashforth)&#x27;</span>);</span><br><span class="line">    title([<span class="string">&#x27;y¡¯(t) = y    &#x27;</span>, <span class="string">&#x27;h = &#x27;</span>,num2str(h)])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% fun.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">fun</span><span class="params">(t,y)</span></span></span><br><span class="line"><span class="comment">%     f=-y+3*cos(3*t)*exp(-t); </span></span><br><span class="line">    f=y;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% Euler.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">E</span> = <span class="title">Euler</span><span class="params">(f,h,a,b,y0)</span></span></span><br><span class="line"><span class="comment">%EULER euler方法计算</span></span><br><span class="line"><span class="comment">%   f为给如的函数</span></span><br><span class="line"><span class="comment">%   h为methods step</span></span><br><span class="line"><span class="comment">%   a b为开始和终止的横坐标</span></span><br><span class="line"><span class="comment">%   y0为传入的y0的初始条件</span></span><br><span class="line"></span><br><span class="line">M=(b-a)/h;</span><br><span class="line">T=a:h:b;</span><br><span class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,M+<span class="number">1</span>);</span><br><span class="line">Y(<span class="number">1</span>)=y0;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:M</span><br><span class="line">    Y(<span class="built_in">i</span>+<span class="number">1</span>)=Y(<span class="built_in">i</span>)+h*feval(f,T(<span class="built_in">i</span>),Y(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">E=[T&#x27; Y&#x27;];</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% AdamBashforth.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span> = <span class="title">AdamBashforth</span><span class="params">(f,h,a,b,y0,y1)</span></span></span><br><span class="line"><span class="comment">%AdamBashforth AdamBashforth方法计算</span></span><br><span class="line"><span class="comment">%   f为给如的函数</span></span><br><span class="line"><span class="comment">%   h为methods step</span></span><br><span class="line"><span class="comment">%   a b为开始和终止的横坐标</span></span><br><span class="line"><span class="comment">%   y0为传入的y0的初始条件</span></span><br><span class="line"><span class="comment">%   y1为由Euler得到</span></span><br><span class="line">M=(b-a)/h;</span><br><span class="line">T=a:h:b;</span><br><span class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,M+<span class="number">1</span>);</span><br><span class="line">Y(<span class="number">1</span>)=y0;    Y(<span class="number">2</span>)=y1;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:M<span class="number">-1</span></span><br><span class="line">    Y(<span class="built_in">i</span>+<span class="number">2</span>)=Y(<span class="built_in">i</span>+<span class="number">1</span>)+<span class="number">1.5</span>*h*feval(f,T(<span class="built_in">i</span>+<span class="number">1</span>),Y(<span class="built_in">i</span>+<span class="number">1</span>))<span class="number">-0.5</span>*h*feval(f,T(<span class="built_in">i</span>),Y(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">A=[T&#x27; Y&#x27;];</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502142044132.png" class title="image-20210502142044132">



<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502142055172.png" class title="image-20210502142055172">

<h2 id="Exercise-Bin-Packing-Problem"><a href="#Exercise-Bin-Packing-Problem" class="headerlink" title="Exercise: Bin Packing Problem"></a>Exercise: Bin Packing Problem</h2><p>Problem: Given a 2D bin of width W, allocate N rectangles of sizes wk × hk so  that the height of the packed rectangles is minimal. </p>
<p>Write a Matlab function that given an order of the rectangles to be packed and their  orientation, puts them from left to right and as low as possible (see below).  Visualize the packing process.</p>
<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502144252350.png" class title="image-20210502144252350">

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 3 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.20) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(3.3) %</span></span><br><span class="line"><span class="comment">% Description:%</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">close all;</span><br><span class="line">clear all;</span><br><span class="line">clc;</span><br><span class="line">nums=<span class="number">25</span>;</span><br><span class="line"><span class="built_in">size</span>=randi(<span class="number">5</span>,nums,<span class="number">2</span>);<span class="comment">%第一列为宽，第二列高；</span></span><br><span class="line"></span><br><span class="line">width=<span class="number">12</span>;</span><br><span class="line">height=<span class="built_in">zeros</span>(<span class="number">1</span>,width);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line">grid on;</span><br><span class="line">axis([<span class="number">0</span> <span class="number">12</span> <span class="number">0</span> <span class="number">24</span>]);</span><br><span class="line">set(gcf,<span class="string">&#x27;position&#x27;</span>,[<span class="number">800</span>,<span class="number">200</span>,<span class="number">400</span>,<span class="number">800</span>]);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:nums  <span class="comment">%对所有箱子遍历</span></span><br><span class="line">    temp=<span class="built_in">zeros</span>(<span class="number">1</span>,width);</span><br><span class="line">    </span><br><span class="line">    temp(<span class="number">1</span>:<span class="number">1</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>)=<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">2</span>);</span><br><span class="line">    height_temp1=height+temp;</span><br><span class="line">    height_temp1(<span class="number">1</span>:<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>))=<span class="built_in">max</span>(height_temp1(<span class="number">1</span>:<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)));</span><br><span class="line">    flag=<span class="number">0</span>; <span class="comment">%记录箱子放置的x的起始点</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">2</span>:width-<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)+<span class="number">1</span> <span class="comment">%把箱子不旋转的情况下，从左到右平移</span></span><br><span class="line">        temp=<span class="built_in">zeros</span>(<span class="number">1</span>,width);</span><br><span class="line">        temp(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>)=<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">%</span></span><br><span class="line">        height_temp2=height+temp;</span><br><span class="line">        <span class="comment">%横着放，要取最大值</span></span><br><span class="line">        height_temp2(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>)=<span class="built_in">max</span>(height_temp2(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>));</span><br><span class="line">        <span class="comment">%</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">max</span>(height_temp1(flag+<span class="number">1</span>:flag+<span class="number">1</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>))&gt;<span class="built_in">max</span>(height_temp2(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>))</span><br><span class="line">            flag=<span class="built_in">j</span><span class="number">-1</span>;</span><br><span class="line">            height_temp1=height_temp2;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">%画箱子</span></span><br><span class="line">    pause();</span><br><span class="line">    coordinate=[flag,<span class="built_in">max</span>(height(flag+<span class="number">1</span>:flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)));flag,height_temp1((flag+<span class="number">1</span>));flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>),height_temp1(flag+<span class="number">1</span>);flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>),<span class="built_in">max</span>(height(flag+<span class="number">1</span>:flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)))];</span><br><span class="line">    fill(coordinate(:,<span class="number">1</span>),coordinate(:,<span class="number">2</span>),<span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">    text(flag+<span class="number">0.5</span>,<span class="number">0.5</span>+<span class="built_in">max</span>(height(flag+<span class="number">1</span>:flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>))),&#123;<span class="built_in">i</span>&#125;);</span><br><span class="line">    <span class="comment">%画箱子</span></span><br><span class="line">    height=height_temp1;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">hold</span> off;</span><br></pre></td></tr></table></figure>

<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502154702292.png" class title="image-20210502154702292">

<h2 id="Exercise-Descent-Method-with-Trust-Region"><a href="#Exercise-Descent-Method-with-Trust-Region" class="headerlink" title="Exercise: Descent Method with Trust Region"></a>Exercise: Descent Method with Trust Region</h2><p>Implement a descent method with trust region that uses a first-order model of the  objective function. The model should be obtained by estimating the objective  function gradient using finite differences. The model can be optimized using any  available method (e.g., golden ratio search)</p>
<p>Test your function using:</p>
<ol>
<li>f(x) = x1 2 + … + xn 2 for different n (use [1 2 … n]T as a starting point),  </li>
<li>g(x) = sin(x) (use 2 as a starting point),</li>
<li>h(x) = exp(x1/5+x2/2)+x1 2+x2 2 (use [5 3]T as a starting point). </li>
<li>Rosenbrock function (use [0 0]T as a starting point).</li>
</ol>
<p>I use func. DescentMethodTrustRegion to get the min and index of function. </p>
<p>To let one function compute can calculate all the value of all kinds of function with multiple variables, I use  function_handle to define the function.</p>
<p>I use func. first_order_derivative get the first order derivative of function f when x=x0.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   main of Descent Method with Trust Region. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">close all;</span><br><span class="line">clear all;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">f = @(x1,x2,x3,x4,x5,x6)x1.^<span class="number">2</span>+x2.^<span class="number">2</span>+x3.^<span class="number">2</span>+x4.^<span class="number">2</span>+x5.^<span class="number">2</span>+x6.^<span class="number">2</span>;</span><br><span class="line">fx0 = <span class="number">1</span>:<span class="number">6</span>;</span><br><span class="line">[Fmin,Fx] = DescentMethodTrustRegion(f,fx0);</span><br><span class="line"></span><br><span class="line">g = @(x)<span class="built_in">sin</span>(x);</span><br><span class="line">gx0 = <span class="number">2</span>;</span><br><span class="line">[Gmin,Gx] = DescentMethodTrustRegion(g,gx0);</span><br><span class="line"></span><br><span class="line">h = @(x1,x2)<span class="built_in">exp</span>(x1/<span class="number">5</span>+x2/<span class="number">2</span>)+x1.^<span class="number">2</span>+x2.^<span class="number">2</span>;</span><br><span class="line">hx0 = [<span class="number">5</span>,<span class="number">3</span>];</span><br><span class="line">[Hmin,Hx] = DescentMethodTrustRegion(h,hx0);</span><br><span class="line"></span><br><span class="line"><span class="built_in">j</span> = @(x,y)(<span class="number">1</span>-x).^<span class="number">2</span>+<span class="number">100</span>*(y-x.^<span class="number">2</span>).^<span class="number">2</span>;</span><br><span class="line">jx0 = [<span class="number">0</span>,<span class="number">0</span>];</span><br><span class="line">[Jmin,Jx] = DescentMethodTrustRegion(<span class="built_in">j</span>,jx0);</span><br><span class="line"></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   use Descent Method with Trust Region. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[min,x]</span> = <span class="title">DescentMethodTrustRegion</span><span class="params">(f,x0)</span></span></span><br><span class="line"><span class="comment">%	min为输出的最小值，x为达到最小值的位置。</span></span><br><span class="line"><span class="comment">%   f为传入的函数，x0为起始的点（可多维）。</span></span><br><span class="line">k=<span class="number">0</span>;    <span class="comment">%跑有限次算法</span></span><br><span class="line">x=x0;   <span class="comment">%传入起点</span></span><br><span class="line">delta=<span class="number">0.1</span>*norm(first_order_derivative(f,x));    <span class="comment">%求梯度的模</span></span><br><span class="line">found=<span class="built_in">false</span>;</span><br><span class="line">k_max=<span class="number">10000</span>;  <span class="comment">%一共跑k_max次算法</span></span><br><span class="line"><span class="keyword">while</span> ~found &amp;&amp; k&lt;=k_max</span><br><span class="line">    k=k+<span class="number">1</span>;</span><br><span class="line">    derivative=first_order_derivative(f,x);     <span class="comment">%在每次更新过x后重新计算梯度。</span></span><br><span class="line">    htr=-derivative/norm(derivative)*delta;   <span class="comment">%除以norm得到方向，乘以delta得到长度。</span></span><br><span class="line">    qh=compute(f,x)+htr*first_order_derivative(f,x)&#x27;;</span><br><span class="line">    r=(compute(f,x)-compute(f,x+htr))/(compute(f,x)-qh);    <span class="comment">%q0,即不加上htr，仅有x</span></span><br><span class="line">    <span class="keyword">if</span> r&gt;<span class="number">0.75</span>               <span class="comment">%到了信赖半径的边缘，扩大</span></span><br><span class="line">        delta = <span class="number">2</span>*delta;                </span><br><span class="line">    <span class="keyword">elseif</span> r&lt;<span class="number">0.25</span>           <span class="comment">%步子太大，缩小，重新走。</span></span><br><span class="line">        delta = delta/<span class="number">3</span>;    </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> r&gt;<span class="number">0</span>      <span class="comment">%说明方向对了，继续走</span></span><br><span class="line">        x = x+htr;      <span class="comment">%更新x</span></span><br><span class="line">        <span class="built_in">min</span> = compute(f,x);   <span class="comment">%计算最小值，用于函数返回，跑够次数，则将min返回。</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    d = norm(first_order_derivative(f,x));    <span class="comment">%计算梯度值得范数（模）</span></span><br><span class="line">    <span class="keyword">if</span> d&lt;=<span class="number">10</span>^<span class="number">-6</span>     <span class="comment">%当模小于...则找到。</span></span><br><span class="line">        found = <span class="built_in">true</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   get first order derivative of Descent Method with Trust Region. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">d</span> = <span class="title">first_order_derivative</span><span class="params">(f,x)</span></span></span><br><span class="line"><span class="comment">%   计算一阶导数</span></span><br><span class="line">len = <span class="built_in">length</span>(x);</span><br><span class="line">d = <span class="built_in">zeros</span>(<span class="number">1</span>,len);</span><br><span class="line">dx=<span class="number">10</span>^<span class="number">-9</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:len</span><br><span class="line">    xi_new = x;</span><br><span class="line">    xi_new(<span class="built_in">i</span>) = x(<span class="built_in">i</span>)+dx;</span><br><span class="line">    v_new = compute(f,xi_new);</span><br><span class="line">    d(<span class="built_in">i</span>) = (v_new-compute(f,x))/(dx);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   compute the value of f when x=x. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">value</span> = <span class="title">compute</span><span class="params">(f,x)</span></span></span><br><span class="line"><span class="comment">%   由于存在多个变量的函数，因此计算值时，x有多个值传入，需要将其去掉括号一起传入。</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">s(<span class="number">1</span>:<span class="number">8</span>) = <span class="string">&#x27;feval(f,&#x27;</span>;    <span class="comment">%由于f在本函数中为传入的参量，在因此最后调用eval执行的是</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(x)<span class="number">-1</span>   <span class="comment">% feval(f,x1,x2,x3.....)。此时f会被真实的函数替代。</span></span><br><span class="line">    s = [s,num2str(x(<span class="built_in">i</span>),<span class="string">&#x27;%10.9e\n&#x27;</span>),<span class="string">&#x27;,&#x27;</span>];   <span class="comment">%将x1,x2,x3....一个个传入</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">s = [s,num2str(x(<span class="keyword">end</span>),<span class="string">&#x27;%10.9e\n&#x27;</span>),<span class="string">&#x27;)&#x27;</span>];     <span class="comment">%传入最后一个数据</span></span><br><span class="line">value = eval(s);            <span class="comment">%计算</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<h2 id="Exercise-Optimization-Based-Sampling-Algorithm"><a href="#Exercise-Optimization-Based-Sampling-Algorithm" class="headerlink" title="Exercise: Optimization-Based Sampling Algorithm"></a>Exercise: Optimization-Based Sampling Algorithm</h2><p>Implement the procedure for improving uniformity of sample distribution generated  by LHS algorithm. Use fmincon routine from Matlab Optimization Toolbox to  directly minimize the uniformity measure with location of the sample points as  design variables.</p>
<p>Use your procedure to generate N points in n-dimensional design space [l1 u1 ] * [l2 u2 ] * … * [ln un ]. Compare the quality of initial and optimized distribution using  both graphical visualization and the uniformity measure implemented in Exercise 1.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: (10) %</span></span><br><span class="line"><span class="comment">% Date:(2016.11.8) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) %</span></span><br><span class="line"><span class="comment">% %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(10.3) %</span></span><br><span class="line"><span class="comment">% Description: Optimization-Based Sampling Algorithm %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">clear;close;</span><br><span class="line">n = <span class="number">2</span>;</span><br><span class="line">N = <span class="number">50</span>;</span><br><span class="line">lb = [<span class="number">0</span>;<span class="number">0</span>].*<span class="built_in">zeros</span>(n,N);</span><br><span class="line">ub = [<span class="number">10</span>;<span class="number">10</span>].*<span class="built_in">ones</span>(n,N);</span><br><span class="line">s = Latin_hypercube_sampling(n,N,lb,ub);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>);</span><br><span class="line">draw(s,[<span class="number">1</span>,<span class="number">2</span>],lb,ub);</span><br><span class="line">title(<span class="string">&#x27;initial samples&#x27;</span>);</span><br><span class="line">u0 = uniformity_cal(s);</span><br><span class="line">options = optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;iter&#x27;</span>,<span class="string">&#x27;TolFun&#x27;</span>,<span class="number">1e-15</span>);</span><br><span class="line">[sf, uf] = fmincon(@uniformity_cal,s,[],[],[],[],lb,ub);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line">draw(sf,[<span class="number">1</span>,<span class="number">2</span>],lb,ub);</span><br><span class="line">title(<span class="string">&#x27;optimized samples&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">s</span> = <span class="title">Latin_hypercube_sampling</span><span class="params">(n,N,lb,ub)</span></span></span><br><span class="line">    delta = (ub-lb)/N;</span><br><span class="line">    bin = <span class="built_in">zeros</span>(n,N);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        bin(<span class="built_in">i</span>,:) = randperm(N)<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    s = delta.*(<span class="built_in">rand</span>(n,N)+bin);</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span><span class="params">(S,sub_space,lb,ub)</span></span></span><br><span class="line">        [n,N] = <span class="built_in">size</span>(S);</span><br><span class="line">        <span class="built_in">plot</span>(S(sub_space(<span class="number">1</span>),<span class="number">1</span>),S(sub_space(<span class="number">2</span>),<span class="number">1</span>),<span class="string">&#x27;ro&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">2</span>:N</span><br><span class="line">        <span class="built_in">plot</span>(S(sub_space(<span class="number">1</span>),<span class="built_in">i</span>),S(sub_space(<span class="number">2</span>),<span class="built_in">i</span>),<span class="string">&#x27;ro&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">        <span class="built_in">hold</span> off;</span><br><span class="line">        grid on;</span><br><span class="line">        axis equal;</span><br><span class="line">        axis([lb(sub_space(<span class="number">1</span>)),ub(sub_space(<span class="number">1</span>)),lb(sub_space(<span class="number">2</span>)),ub(sub_space(<span class="number">2</span>))]);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniformity</span> = <span class="title">uniformity_cal</span><span class="params">(S)</span></span></span><br><span class="line">    [n,N] = <span class="built_in">size</span>(S);</span><br><span class="line">    uniformity = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:N</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="built_in">i</span>+<span class="number">1</span>:N</span><br><span class="line">            uniformity = uniformity+<span class="number">1</span>/sum((S(:,<span class="built_in">i</span>)-S(:,<span class="built_in">j</span>)).^<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2021/05/02/Nonlinear_Optimization%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98/image-20210502150511302.png" class title="image-20210502150511302">
























    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/course/" rel="tag"># course</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/20/Speckle_Images%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/" rel="prev" title="Speckle_Images散斑图像比对">
      <i class="fa fa-chevron-left"></i> Speckle_Images散斑图像比对
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/05/02/Nonlinear-Optimization-TSP/" rel="next" title="Nonlinear_Optimization_TSP">
      Nonlinear_Optimization_TSP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          المحتويات
        </li>
        <li class="sidebar-nav-overview">
          عام
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Nonlinear-Optimization-%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98"><span class="nav-number">1.</span> <span class="nav-text">Nonlinear_Optimization 的一些有意思的题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Exercise-Polynomial-Interpolation"><span class="nav-number">1.1.</span> <span class="nav-text">Exercise: Polynomial Interpolation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exercise-Numerical-Methods-for-ODEs"><span class="nav-number">1.2.</span> <span class="nav-text">Exercise: Numerical Methods for ODEs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exercise-Bin-Packing-Problem"><span class="nav-number">1.3.</span> <span class="nav-text">Exercise: Bin Packing Problem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exercise-Descent-Method-with-Trust-Region"><span class="nav-number">1.4.</span> <span class="nav-text">Exercise: Descent Method with Trust Region</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exercise-Optimization-Based-Sampling-Algorithm"><span class="nav-number">1.5.</span> <span class="nav-text">Exercise: Optimization-Based Sampling Algorithm</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Wilson Xu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">المقالات</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">الوسوم</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wilson Xu</span>
</div>
  <div class="powered-by">تطبيق الموقع <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  















  

  

  

</body>
</html>
