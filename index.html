<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"8.0.0-rc.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":false,"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Wilson&#39;s Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Wilson&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Wilson Xu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-cn'
  };
</script>

  <title>Wilson's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Navigationsleiste an/ausschalten">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Wilson's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wilson Xu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wilson's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/" class="post-title-link" itemprop="url">高级非线性优化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>
              

              <time title="Erstellt: 2021-05-02 13:39:17 / Geändert am: 15:52:44" itemprop="dateCreated datePublished" datetime="2021-05-02T13:39:17+08:00">2021-05-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="非线性优化"><a href="#非线性优化" class="headerlink" title="非线性优化"></a>非线性优化</h1><p>非线性优化这门课是在2019年秋季学期上的。使用matlab实现各种优化算法，其中涉及到：</p>
<p>• Matlab programming </p>
<p>• math review • classical optimization methods </p>
<p>• unconstrained/constrained optimization  </p>
<p>• gradient-based/non-gradient optimization approaches </p>
<p>• recent advances in modeling and optimization research  relevant to electrical engineering </p>
<p>• knowledge based methods such as surrogate and Space  Mapping (SM) optimization </p>
<p>• global optimization approaches such as particle swarm  optimization (PSO)</p>
<p>使用matlab进行编程，难度不高，但也存在一些非常有意思的题目。在此分享题目与其对应解答。</p>
<h2 id="Exercise-Polynomial-Interpolation"><a href="#Exercise-Polynomial-Interpolation" class="headerlink" title="Exercise: Polynomial Interpolation"></a>Exercise: Polynomial Interpolation</h2><p>Write a Matlab function that finds a polynomial interpolating the data set {(xi,yi)},  i =1,…,n, finds all local minima and maxima of this polynomial and plots both the  polynomial, its first-order derivative, input data set as well as locations of the  minima/maxima.</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502141321603.png" class title="image-20210502141321603">

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">clear all;  close all;  clc;</span><br><span class="line">dataset=[<span class="number">0</span>,<span class="number">0</span>;<span class="number">2</span>,<span class="number">-1</span>;<span class="number">2.8</span>,<span class="number">5</span>;<span class="number">4</span>,<span class="number">2</span>;<span class="number">5</span>,<span class="number">-1</span>;<span class="number">6</span>,<span class="number">5</span>;<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">axis([<span class="number">0</span> <span class="number">7</span> <span class="number">-50</span> <span class="number">20</span>])</span><br><span class="line"><span class="built_in">hold</span> on;    grid on;</span><br><span class="line"></span><br><span class="line">x=dataset(:,<span class="number">1</span>);</span><br><span class="line">v=dataset(:,<span class="number">2</span>);</span><br><span class="line">P=polyfit(x,v,<span class="built_in">length</span>(x)<span class="number">-1</span>);</span><br><span class="line">dt = <span class="number">0.01</span>;</span><br><span class="line">xx = <span class="built_in">min</span>(x):dt:<span class="built_in">max</span>(x);</span><br><span class="line">yy = polyval(P,xx);</span><br><span class="line"><span class="built_in">plot</span>(xx,yy,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">% % 多项式插值结果</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(dataset(:,<span class="number">1</span>),dataset(:,<span class="number">2</span>),<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);        <span class="comment">%Data points</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>([<span class="number">0</span>,<span class="number">7</span>],[<span class="number">0</span>,<span class="number">0</span>],<span class="string">&#x27;r&#x27;</span>);      <span class="comment">%Zero level</span></span><br><span class="line"></span><br><span class="line">Y_diff=diff(yy)/dt;</span><br><span class="line"><span class="built_in">plot</span>(xx(<span class="number">1</span>:<span class="number">700</span>),Y_diff,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">1</span>);  <span class="comment">% First-order derivative of p</span></span><br><span class="line"></span><br><span class="line">index_max=<span class="built_in">intersect</span>(<span class="built_in">find</span>(diff(yy)&gt;<span class="number">0</span>)+<span class="number">1</span>,<span class="built_in">find</span>(diff(yy)&lt;<span class="number">0</span>));   <span class="comment">%找到极大值</span></span><br><span class="line">index_min=<span class="built_in">intersect</span>(<span class="built_in">find</span>(diff(yy)&lt;<span class="number">0</span>)+<span class="number">1</span>,<span class="built_in">find</span>(diff(yy)&gt;<span class="number">0</span>));   <span class="comment">%找到极小值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(xx(index_max),yy(index_max),<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;markersize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(xx(index_max),Y_diff(index_max));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(index_max)</span><br><span class="line">    line([xx(index_max(<span class="built_in">i</span>)),xx(index_max(<span class="built_in">i</span>))],[Y_diff(index_max(<span class="built_in">i</span>)),yy(index_max(<span class="built_in">i</span>))],<span class="string">&#x27;linestyle&#x27;</span>,<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span>         <span class="comment">%Locations of local maxima/minima</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(xx(index_min),yy(index_min),<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;markersize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(xx(index_min),Y_diff(index_min));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(index_min)</span><br><span class="line">    line([xx(index_min(<span class="built_in">i</span>)),xx(index_min(<span class="built_in">i</span>))],[Y_diff(index_min(<span class="built_in">i</span>)),yy(index_min(<span class="built_in">i</span>))],<span class="string">&#x27;linestyle&#x27;</span>,<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span>         <span class="comment">%Locations of local maxima/minima</span></span><br><span class="line">  <span class="built_in">plot</span>([<span class="number">0</span>,<span class="number">7</span>],[<span class="number">0</span>,<span class="number">0</span>],<span class="string">&#x27;r&#x27;</span>);      <span class="comment">%Zero level</span></span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;Interpolation polynomial p&#x27;</span>,<span class="string">&#x27;Data points&#x27;</span>,<span class="string">&#x27;Zero level&#x27;</span>,<span class="string">&#x27;First-order derivative of p&#x27;</span>,<span class="string">&#x27;Locations of local maxima/minima&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">hold</span> off;  </span><br></pre></td></tr></table></figure>



<h2 id="Exercise-Numerical-Methods-for-ODEs"><a href="#Exercise-Numerical-Methods-for-ODEs" class="headerlink" title="Exercise: Numerical Methods for ODEs"></a>Exercise: Numerical Methods for ODEs</h2><p>First-order ordinary differential equation can be written in the form of y’(t) = f(t,y(t))  with the initial condition y(t0) = y0. </p>
<p>Write Matlab functions that solve this equation using Euler’s method (yn+1 = yn +  h·f(tn,yn), where tn+1 = tn + h, and h is the method’s step) and Adams-Bashforth  method (yn+2 = yn+1 + 1.5·h·f(tn+1,yn+1) – 0.5·h·f(tn,yn), with tn and h as before). </p>
<p>Test your functions by solving two equations: y’(t) = -y + 3cos(3t)·exp(-t), y(0) = 0  (exact solution: y(t) = sin(3t)·exp(-t)), and y’(t) = y, y(0) = 1 (exact solution y(t) =  exp(t)). Plot the numerical and exact solutions for 0 ≤ t ≤ 5. Consider h = 0.2, 0.1,  0.05, and 0.01.</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502141618290.png" class title="image-20210502141618290">

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% main.m</span></span><br><span class="line">clear all;</span><br><span class="line">close all;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">a=<span class="number">0</span>;    b=<span class="number">5</span>;    y0=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">h_temp=[<span class="number">0.2</span>,<span class="number">0.1</span>,<span class="number">0.05</span>,<span class="number">0.01</span>];</span><br><span class="line">f=<span class="string">&#x27;fun&#x27;</span>;</span><br><span class="line">p=<span class="built_in">figure</span>;</span><br><span class="line">set(p,<span class="string">&#x27;position&#x27;</span>,[<span class="number">100</span> <span class="number">100</span> <span class="number">1000</span> <span class="number">600</span>]);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    h=h_temp(<span class="built_in">i</span>);</span><br><span class="line">    E=Euler(f,h,a,b,y0);</span><br><span class="line">    y1=E(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">    A=AdamBashforth(f,h,a,b,y0,y1);</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="built_in">i</span>);</span><br><span class="line"><span class="comment">%     axis([0 5 -0.4 1]);</span></span><br><span class="line">    <span class="built_in">hold</span> on;    grid on;</span><br><span class="line">    t=a:h:b;</span><br><span class="line">    y=<span class="built_in">exp</span>(t);</span><br><span class="line">    <span class="built_in">plot</span>(t,y,<span class="string">&#x27;b&#x27;</span>)       <span class="comment">%Exact solution</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">plot</span>(E(:,<span class="number">1</span>),E(:,<span class="number">2</span>),<span class="string">&#x27;-.&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;k&#x27;</span>);</span><br><span class="line">    <span class="comment">%Euler</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">plot</span>(A(:,<span class="number">1</span>),A(:,<span class="number">2</span>),<span class="string">&#x27;k&#x27;</span>);  <span class="comment">%AdamBashfort</span></span><br><span class="line">    <span class="built_in">hold</span> off;</span><br><span class="line">    <span class="built_in">legend</span>(<span class="string">&#x27;Exact solution&#x27;</span>,<span class="string">&#x27;Numerical solution (Euler)&#x27;</span>,<span class="string">&#x27;Numerical solution (Adams-Bashforth)&#x27;</span>);</span><br><span class="line">    title([<span class="string">&#x27;y¡¯(t) = y    &#x27;</span>, <span class="string">&#x27;h = &#x27;</span>,num2str(h)])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% fun.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">fun</span><span class="params">(t,y)</span></span></span><br><span class="line"><span class="comment">%     f=-y+3*cos(3*t)*exp(-t); </span></span><br><span class="line">    f=y;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% Euler.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">E</span> = <span class="title">Euler</span><span class="params">(f,h,a,b,y0)</span></span></span><br><span class="line"><span class="comment">%EULER euler方法计算</span></span><br><span class="line"><span class="comment">%   f为给如的函数</span></span><br><span class="line"><span class="comment">%   h为methods step</span></span><br><span class="line"><span class="comment">%   a b为开始和终止的横坐标</span></span><br><span class="line"><span class="comment">%   y0为传入的y0的初始条件</span></span><br><span class="line"></span><br><span class="line">M=(b-a)/h;</span><br><span class="line">T=a:h:b;</span><br><span class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,M+<span class="number">1</span>);</span><br><span class="line">Y(<span class="number">1</span>)=y0;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:M</span><br><span class="line">    Y(<span class="built_in">i</span>+<span class="number">1</span>)=Y(<span class="built_in">i</span>)+h*feval(f,T(<span class="built_in">i</span>),Y(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">E=[T&#x27; Y&#x27;];</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%%% AdamBashforth.m</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span> = <span class="title">AdamBashforth</span><span class="params">(f,h,a,b,y0,y1)</span></span></span><br><span class="line"><span class="comment">%AdamBashforth AdamBashforth方法计算</span></span><br><span class="line"><span class="comment">%   f为给如的函数</span></span><br><span class="line"><span class="comment">%   h为methods step</span></span><br><span class="line"><span class="comment">%   a b为开始和终止的横坐标</span></span><br><span class="line"><span class="comment">%   y0为传入的y0的初始条件</span></span><br><span class="line"><span class="comment">%   y1为由Euler得到</span></span><br><span class="line">M=(b-a)/h;</span><br><span class="line">T=a:h:b;</span><br><span class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,M+<span class="number">1</span>);</span><br><span class="line">Y(<span class="number">1</span>)=y0;    Y(<span class="number">2</span>)=y1;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:M<span class="number">-1</span></span><br><span class="line">    Y(<span class="built_in">i</span>+<span class="number">2</span>)=Y(<span class="built_in">i</span>+<span class="number">1</span>)+<span class="number">1.5</span>*h*feval(f,T(<span class="built_in">i</span>+<span class="number">1</span>),Y(<span class="built_in">i</span>+<span class="number">1</span>))<span class="number">-0.5</span>*h*feval(f,T(<span class="built_in">i</span>),Y(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">A=[T&#x27; Y&#x27;];</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502142044132.png" class title="image-20210502142044132">



<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502142055172.png" class title="image-20210502142055172">

<h2 id="Exercise-Travelling-Salesman-Problem"><a href="#Exercise-Travelling-Salesman-Problem" class="headerlink" title="Exercise: Travelling Salesman Problem"></a>Exercise: Travelling Salesman Problem</h2><p>There are N cities with the distance between city i and city j given by dij. Problem:  find a close route through all the cities so that minimizes the total route length. </p>
<p>Write a Matlab function that implements the objective function for this problem.  The input arguments are a route described as a permutation of the numbers 1 to N,  as well as the distance data stored in an appropriate form.</p>
<p>Demonstrate operation of your function using examples of your choice. Visualize  the cities location as well as a route using suitable plots (see below). </p>
<p>Implement and visualize simple optimization procedure that modifies the route by  random swapping two cities on the route (the updated route is accepted if it reduces  the objective function).</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502142240519.png" class title="image-20210502142240519">

<h3 id="笨方法"><a href="#笨方法" class="headerlink" title="笨方法"></a>笨方法</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 3 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.20) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(3.2) %</span></span><br><span class="line"><span class="comment">% Description: STUPID methods for Travelling Salesman Problem. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">close all;</span><br><span class="line">clear all;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">NUM_city=<span class="number">12</span>;    <span class="comment">%多少个城市</span></span><br><span class="line">NUM_G= prod(<span class="number">1</span>:NUM_city);   <span class="comment">%算法跑多少遍</span></span><br><span class="line"><span class="comment">% NUM_G=100;</span></span><br><span class="line"></span><br><span class="line">cities=<span class="built_in">floor</span>(<span class="built_in">rand</span>(<span class="number">2</span>,NUM_city)*<span class="number">100</span>); <span class="comment">%随机城市位置</span></span><br><span class="line">distances = calculateDistance(cities);</span><br><span class="line">SUM_distance=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:NUM_city<span class="number">-1</span></span><br><span class="line">    SUM_distance=SUM_distance+distances(<span class="built_in">i</span>,<span class="built_in">i</span>+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">paint(cities);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> time=<span class="number">1</span>:NUM_G</span><br><span class="line">    draw_flag=<span class="number">0</span>;</span><br><span class="line">    index=randperm(NUM_city);</span><br><span class="line">    temp_cities=cities(:,index);</span><br><span class="line">    temp_distances = calculateDistance(temp_cities);</span><br><span class="line">    temp_SUM_distance=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:NUM_city<span class="number">-1</span></span><br><span class="line">        temp_SUM_distance=temp_SUM_distance+temp_distances(<span class="built_in">i</span>,<span class="built_in">i</span>+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> SUM_distance&gt;temp_SUM_distance</span><br><span class="line">        SUM_distance=temp_SUM_distance;</span><br><span class="line">        draw_flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> draw_flag==<span class="number">1</span></span><br><span class="line">        paint(temp_cities);</span><br><span class="line">        <span class="comment">%画图</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ distances ]</span> = <span class="title">calculateDistance</span><span class="params">( city )</span></span></span><br><span class="line">    [~, col] = <span class="built_in">size</span>(city);</span><br><span class="line">    distances = <span class="built_in">zeros</span>(col);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:col</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:col</span><br><span class="line">            distances(<span class="built_in">i</span>,<span class="built_in">j</span>)=distances(<span class="built_in">i</span>,<span class="built_in">j</span>)+ <span class="built_in">sqrt</span>((city(<span class="number">1</span>,<span class="built_in">i</span>)-city(<span class="number">1</span>,<span class="built_in">j</span>))^<span class="number">2</span>+(city(<span class="number">2</span>,<span class="built_in">i</span>)-city(<span class="number">2</span>,<span class="built_in">j</span>))^<span class="number">2</span>  );           </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[]</span> = <span class="title">paint</span><span class="params">(cities)</span></span></span><br><span class="line">        pause(<span class="number">0.2</span>);</span><br><span class="line">        <span class="built_in">figure</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">plot</span>(cities(<span class="number">1</span>,:),cities(<span class="number">2</span>,:),<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;MarkerSize&#x27;</span>, <span class="number">8</span>);</span><br><span class="line">        axis equal</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">        <span class="built_in">plot</span>(cities(<span class="number">1</span>,:),cities(<span class="number">2</span>,:), <span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">        axis equal</span><br><span class="line">        grid on</span><br><span class="line">        drawnow</span><br><span class="line">        <span class="built_in">hold</span> off;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>I use function rand to get the cities position. Write function calculateDistance to get the distances between cities. Then  use randperm to swap the order of cities, get the new total distance. If it get smaller, draw the path. I just use a <strong>very stupid way</strong> to get the answer, and it needs a lot of time to get the answer. The better algorithm is the  <strong>Genetic algorithm</strong>.</p>
<p>在这里第一次接触优化算法，笨方法效率太低，跑的太慢。在后面的练习中，使用了多种不同的算法来解决TSP问题。</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502142544445.png" class title="image-20210502142544445">



<h3 id="GA算法"><a href="#GA算法" class="headerlink" title="GA算法"></a>GA算法</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line">tStart = tic; <span class="comment">% 算法计时器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%%%%%%%%%%%%自定义参数%%%%%%%%%%%%%</span></span><br><span class="line"></span><br><span class="line">cityNum = <span class="number">200</span>;</span><br><span class="line">maxGEN = <span class="number">200000</span>;</span><br><span class="line">popSize = <span class="number">100</span>; <span class="comment">% 遗传算法种群大小</span></span><br><span class="line">crossoverProbabilty = <span class="number">0.9</span>; <span class="comment">%交叉概率</span></span><br><span class="line">mutationProbabilty = <span class="number">0.1</span>; <span class="comment">%变异概率</span></span><br><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"></span><br><span class="line">gbest = Inf;</span><br><span class="line"><span class="comment">% 随机生成城市位置</span></span><br><span class="line">cities = <span class="built_in">rand</span>(<span class="number">2</span>,cityNum) * <span class="number">100</span>;<span class="comment">%100是最远距离</span></span><br><span class="line"><span class="comment">% 计算上述生成的城市距离</span></span><br><span class="line">distances = calculateDistance(cities);</span><br><span class="line"><span class="comment">% 生成种群，每个个体代表一个路径</span></span><br><span class="line">pop = <span class="built_in">zeros</span>(popSize, cityNum);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:popSize</span><br><span class="line">pop(<span class="built_in">i</span>,:) = randperm(cityNum); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">offspring = <span class="built_in">zeros</span>(popSize,cityNum);</span><br><span class="line"><span class="comment">%保存每代的最小路劲便于画图</span></span><br><span class="line">minPathes = <span class="built_in">zeros</span>(maxGEN,<span class="number">1</span>);</span><br><span class="line"><span class="comment">% GA算法</span></span><br><span class="line"><span class="keyword">for</span>  gen=<span class="number">1</span>:maxGEN</span><br><span class="line">    <span class="comment">% 计算适应度的值，即路径总距离</span></span><br><span class="line">    [fval, sumDistance, minPath, maxPath] = fitness(distances, pop);</span><br><span class="line">    <span class="comment">% 轮盘赌选择</span></span><br><span class="line">    tournamentSize=<span class="number">4</span>; <span class="comment">%设置大小</span></span><br><span class="line">    <span class="keyword">for</span> k=<span class="number">1</span>:popSize</span><br><span class="line">    <span class="comment">% 选择父代进行交叉</span></span><br><span class="line">        tourPopDistances=<span class="built_in">zeros</span>( tournamentSize,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:tournamentSize</span><br><span class="line">            randomRow = randi(popSize);</span><br><span class="line">            tourPopDistances(<span class="built_in">i</span>,<span class="number">1</span>) = sumDistance(randomRow,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">% 选择最好的，即距离最小的</span></span><br><span class="line">        parent1  = <span class="built_in">min</span>(tourPopDistances);</span><br><span class="line">        [parent1X,parent1Y] = <span class="built_in">find</span>(sumDistance==parent1,<span class="number">1</span>, <span class="string">&#x27;first&#x27;</span>);</span><br><span class="line">        parent1Path = pop(parent1X(<span class="number">1</span>,<span class="number">1</span>),:);</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:tournamentSize</span><br><span class="line">            randomRow = randi(popSize);</span><br><span class="line">            tourPopDistances(<span class="built_in">i</span>,<span class="number">1</span>) = sumDistance(randomRow,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        parent2  = <span class="built_in">min</span>(tourPopDistances);</span><br><span class="line">        [parent2X,parent2Y] = <span class="built_in">find</span>(sumDistance==parent2,<span class="number">1</span>, <span class="string">&#x27;first&#x27;</span>);</span><br><span class="line">        parent2Path = pop(parent2X(<span class="number">1</span>,<span class="number">1</span>),:);</span><br><span class="line">        subPath = crossover(parent1Path, parent2Path, crossoverProbabilty);<span class="comment">%交叉</span></span><br><span class="line">        subPath = mutate(subPath, mutationProbabilty);<span class="comment">%变异</span></span><br><span class="line">        offspring(k,:) = subPath(<span class="number">1</span>,:);</span><br><span class="line">        minPathes(gen,<span class="number">1</span>) = minPath; </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    fprintf(<span class="string">&#x27;代数:%d   最短路径:%.2fKM \n&#x27;</span>, gen,minPath);</span><br><span class="line">    <span class="comment">% 更新</span></span><br><span class="line">    pop = offspring;</span><br><span class="line">    <span class="comment">% 画出当前状态下的最短路径</span></span><br><span class="line">    <span class="keyword">if</span> minPath &lt; gbest</span><br><span class="line">    gbest = minPath;</span><br><span class="line">    paint(cities, pop, gbest, sumDistance,gen);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">figure</span> </span><br><span class="line"><span class="built_in">plot</span>(minPathes, <span class="string">&#x27;MarkerFaceColor&#x27;</span>, <span class="string">&#x27;red&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">title(<span class="string">&#x27;收敛曲线图（每一代的最短路径）&#x27;</span>);</span><br><span class="line">set(gca,<span class="string">&#x27;ytick&#x27;</span>,<span class="number">500</span>:<span class="number">100</span>:<span class="number">5000</span>); </span><br><span class="line">ylabel(<span class="string">&#x27;路径长度&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;迭代次数&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">tEnd = toc(tStart);</span><br><span class="line">fprintf(<span class="string">&#x27;时间:%d 分  %f 秒.\n&#x27;</span>, <span class="built_in">floor</span>(tEnd/<span class="number">60</span>), <span class="built_in">rem</span>(tEnd,<span class="number">60</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ fitnessvar, sumDistances,minPath, maxPath ]</span> = <span class="title">fitness</span><span class="params">( distances, pop )</span></span></span><br><span class="line"><span class="comment">% 计算整个种群的适应度值</span></span><br><span class="line"> </span><br><span class="line">    [popSize, col] = <span class="built_in">size</span>(pop);</span><br><span class="line">    sumDistances = <span class="built_in">zeros</span>(popSize,<span class="number">1</span>);</span><br><span class="line">    fitnessvar = <span class="built_in">zeros</span>(popSize,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:popSize</span><br><span class="line">       <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:col<span class="number">-1</span></span><br><span class="line">          sumDistances(<span class="built_in">i</span>) = sumDistances(<span class="built_in">i</span>) + distances(pop(<span class="built_in">i</span>,<span class="built_in">j</span>),pop(<span class="built_in">i</span>,<span class="built_in">j</span>+<span class="number">1</span>));</span><br><span class="line">       <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    minPath = <span class="built_in">min</span>(sumDistances);</span><br><span class="line">    maxPath = <span class="built_in">max</span>(sumDistances);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(sumDistances)</span><br><span class="line">        fitnessvar(<span class="built_in">i</span>,<span class="number">1</span>)=(maxPath - sumDistances(<span class="built_in">i</span>,<span class="number">1</span>)+<span class="number">0.000001</span>) / (maxPath-minPath+<span class="number">0.00000001</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ distances ]</span> = <span class="title">calculateDistance</span><span class="params">( city )</span></span></span><br><span class="line">    [~, col] = <span class="built_in">size</span>(city);</span><br><span class="line">    distances = <span class="built_in">zeros</span>(col);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:col</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:col</span><br><span class="line">            distances(<span class="built_in">i</span>,<span class="built_in">j</span>)=distances(<span class="built_in">i</span>,<span class="built_in">j</span>)+ <span class="built_in">sqrt</span>((city(<span class="number">1</span>,<span class="built_in">i</span>)-city(<span class="number">1</span>,<span class="built_in">j</span>))^<span class="number">2</span>+(city(<span class="number">2</span>,<span class="built_in">i</span>)-city(<span class="number">2</span>,<span class="built_in">j</span>))^<span class="number">2</span>  );           </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[childPath]</span> = <span class="title">crossover</span><span class="params">(parent1Path, parent2Path, prob)</span></span></span><br><span class="line">    random = <span class="built_in">rand</span>();</span><br><span class="line">    <span class="keyword">if</span> prob &gt;= random</span><br><span class="line">        [l, <span class="built_in">length</span>] = <span class="built_in">size</span>(parent1Path);</span><br><span class="line">        childPath = <span class="built_in">zeros</span>(l,<span class="built_in">length</span>);</span><br><span class="line">        setSize = <span class="built_in">floor</span>(<span class="built_in">length</span>/<span class="number">2</span>) <span class="number">-1</span>;</span><br><span class="line">        offset = randi(setSize);</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span>=offset:setSize+offset<span class="number">-1</span></span><br><span class="line">            childPath(<span class="number">1</span>,<span class="built_in">i</span>) = parent1Path(<span class="number">1</span>,<span class="built_in">i</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        iterator = <span class="built_in">i</span>+<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">j</span> = iterator;</span><br><span class="line">        <span class="keyword">while</span> any(childPath == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">j</span> &gt; <span class="built_in">length</span></span><br><span class="line">                <span class="built_in">j</span> = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> iterator &gt; <span class="built_in">length</span></span><br><span class="line">                iterator = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">if</span> ~any(childPath == parent2Path(<span class="number">1</span>,<span class="built_in">j</span>))</span><br><span class="line">                childPath(<span class="number">1</span>,iterator) = parent2Path(<span class="number">1</span>,<span class="built_in">j</span>);</span><br><span class="line">               iterator = iterator + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="built_in">j</span> = <span class="built_in">j</span> + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        childPath = parent1Path;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ mutatedPath ]</span> = <span class="title">mutate</span><span class="params">( path, prob )</span></span></span><br><span class="line"><span class="comment">%对指定的路径利用指定的概率进行更新</span></span><br><span class="line">    random = <span class="built_in">rand</span>();</span><br><span class="line">    <span class="keyword">if</span> random &lt;= prob</span><br><span class="line">        [l,<span class="built_in">length</span>] = <span class="built_in">size</span>(path);</span><br><span class="line">        index1 = randi(<span class="built_in">length</span>);</span><br><span class="line">        index2 = randi(<span class="built_in">length</span>);</span><br><span class="line">        <span class="comment">%交换</span></span><br><span class="line">        temp = path(l,index1);</span><br><span class="line">        path(l,index1) = path(l,index2);</span><br><span class="line">        path(l,index2)=temp;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">        mutatedPath = path; </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<p>相比于纯随机算法而言，EA 算法明显的提高了效率，加快了优化的速度。在 Lab3 的作业中，使用 5/12/25/40 的城市数量进行测试。最终得到了答案。但由于当时没有记录时间，因此缺失一部分数据。可以记得的是，当 城市数量增加后，耗时明显增加，以至于最高只能测试 40 个城市的情况。 EA 算法中，收敛曲线表明了收敛的过程，随着城市数量的增加，收敛速度减缓。但依旧在 13 秒内，得到了 50 个城市的情况，24 秒得到了 100 个城市的情况（可能未达到最优）。在测试 200 城市的时候，使用了实验室 服务器，因此出现乱码；结果显示，耗时 212 分 33 秒，完成了对 200 城市情况的计算。</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502150017090.png" alt="image-20210502150017090">



<h2 id="Exercise-Bin-Packing-Problem"><a href="#Exercise-Bin-Packing-Problem" class="headerlink" title="Exercise: Bin Packing Problem"></a>Exercise: Bin Packing Problem</h2><p>Problem: Given a 2D bin of width W, allocate N rectangles of sizes wk × hk so  that the height of the packed rectangles is minimal. </p>
<p>Write a Matlab function that given an order of the rectangles to be packed and their  orientation, puts them from left to right and as low as possible (see below).  Visualize the packing process.</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502144252350.png" class title="image-20210502144252350">

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 3 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.20) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(3.3) %</span></span><br><span class="line"><span class="comment">% Description:%</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">close all;</span><br><span class="line">clear all;</span><br><span class="line">clc;</span><br><span class="line">nums=<span class="number">25</span>;</span><br><span class="line"><span class="built_in">size</span>=randi(<span class="number">5</span>,nums,<span class="number">2</span>);<span class="comment">%第一列为宽，第二列高；</span></span><br><span class="line"></span><br><span class="line">width=<span class="number">12</span>;</span><br><span class="line">height=<span class="built_in">zeros</span>(<span class="number">1</span>,width);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line">grid on;</span><br><span class="line">axis([<span class="number">0</span> <span class="number">12</span> <span class="number">0</span> <span class="number">24</span>]);</span><br><span class="line">set(gcf,<span class="string">&#x27;position&#x27;</span>,[<span class="number">800</span>,<span class="number">200</span>,<span class="number">400</span>,<span class="number">800</span>]);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:nums  <span class="comment">%对所有箱子遍历</span></span><br><span class="line">    temp=<span class="built_in">zeros</span>(<span class="number">1</span>,width);</span><br><span class="line">    </span><br><span class="line">    temp(<span class="number">1</span>:<span class="number">1</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>)=<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">2</span>);</span><br><span class="line">    height_temp1=height+temp;</span><br><span class="line">    height_temp1(<span class="number">1</span>:<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>))=<span class="built_in">max</span>(height_temp1(<span class="number">1</span>:<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)));</span><br><span class="line">    flag=<span class="number">0</span>; <span class="comment">%记录箱子放置的x的起始点</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">2</span>:width-<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)+<span class="number">1</span> <span class="comment">%把箱子不旋转的情况下，从左到右平移</span></span><br><span class="line">        temp=<span class="built_in">zeros</span>(<span class="number">1</span>,width);</span><br><span class="line">        temp(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>)=<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">%</span></span><br><span class="line">        height_temp2=height+temp;</span><br><span class="line">        <span class="comment">%横着放，要取最大值</span></span><br><span class="line">        height_temp2(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>)=<span class="built_in">max</span>(height_temp2(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>));</span><br><span class="line">        <span class="comment">%</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">max</span>(height_temp1(flag+<span class="number">1</span>:flag+<span class="number">1</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>))&gt;<span class="built_in">max</span>(height_temp2(<span class="built_in">j</span>:<span class="built_in">j</span>+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)<span class="number">-1</span>))</span><br><span class="line">            flag=<span class="built_in">j</span><span class="number">-1</span>;</span><br><span class="line">            height_temp1=height_temp2;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">%画箱子</span></span><br><span class="line">    pause();</span><br><span class="line">    coordinate=[flag,<span class="built_in">max</span>(height(flag+<span class="number">1</span>:flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)));flag,height_temp1((flag+<span class="number">1</span>));flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>),height_temp1(flag+<span class="number">1</span>);flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>),<span class="built_in">max</span>(height(flag+<span class="number">1</span>:flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>)))];</span><br><span class="line">    fill(coordinate(:,<span class="number">1</span>),coordinate(:,<span class="number">2</span>),<span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">    text(flag+<span class="number">0.5</span>,<span class="number">0.5</span>+<span class="built_in">max</span>(height(flag+<span class="number">1</span>:flag+<span class="built_in">size</span>(<span class="built_in">i</span>,<span class="number">1</span>))),&#123;<span class="built_in">i</span>&#125;);</span><br><span class="line">    <span class="comment">%画箱子</span></span><br><span class="line">    height=height_temp1;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">hold</span> off;</span><br></pre></td></tr></table></figure>

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502154702292.png" class title="image-20210502154702292">

<h2 id="Exercise-Descent-Method-with-Trust-Region"><a href="#Exercise-Descent-Method-with-Trust-Region" class="headerlink" title="Exercise: Descent Method with Trust Region"></a>Exercise: Descent Method with Trust Region</h2><p>Implement a descent method with trust region that uses a first-order model of the  objective function. The model should be obtained by estimating the objective  function gradient using finite differences. The model can be optimized using any  available method (e.g., golden ratio search)</p>
<p>Test your function using:</p>
<ol>
<li>f(x) = x1 2 + … + xn 2 for different n (use [1 2 … n]T as a starting point),  </li>
<li>g(x) = sin(x) (use 2 as a starting point),</li>
<li>h(x) = exp(x1/5+x2/2)+x1 2+x2 2 (use [5 3]T as a starting point). </li>
<li>Rosenbrock function (use [0 0]T as a starting point).</li>
</ol>
<p>I use func. DescentMethodTrustRegion to get the min and index of function. </p>
<p>To let one function compute can calculate all the value of all kinds of function with multiple variables, I use  function_handle to define the function.</p>
<p>I use func. first_order_derivative get the first order derivative of function f when x=x0.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   main of Descent Method with Trust Region. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">close all;</span><br><span class="line">clear all;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">f = @(x1,x2,x3,x4,x5,x6)x1.^<span class="number">2</span>+x2.^<span class="number">2</span>+x3.^<span class="number">2</span>+x4.^<span class="number">2</span>+x5.^<span class="number">2</span>+x6.^<span class="number">2</span>;</span><br><span class="line">fx0 = <span class="number">1</span>:<span class="number">6</span>;</span><br><span class="line">[Fmin,Fx] = DescentMethodTrustRegion(f,fx0);</span><br><span class="line"></span><br><span class="line">g = @(x)<span class="built_in">sin</span>(x);</span><br><span class="line">gx0 = <span class="number">2</span>;</span><br><span class="line">[Gmin,Gx] = DescentMethodTrustRegion(g,gx0);</span><br><span class="line"></span><br><span class="line">h = @(x1,x2)<span class="built_in">exp</span>(x1/<span class="number">5</span>+x2/<span class="number">2</span>)+x1.^<span class="number">2</span>+x2.^<span class="number">2</span>;</span><br><span class="line">hx0 = [<span class="number">5</span>,<span class="number">3</span>];</span><br><span class="line">[Hmin,Hx] = DescentMethodTrustRegion(h,hx0);</span><br><span class="line"></span><br><span class="line"><span class="built_in">j</span> = @(x,y)(<span class="number">1</span>-x).^<span class="number">2</span>+<span class="number">100</span>*(y-x.^<span class="number">2</span>).^<span class="number">2</span>;</span><br><span class="line">jx0 = [<span class="number">0</span>,<span class="number">0</span>];</span><br><span class="line">[Jmin,Jx] = DescentMethodTrustRegion(<span class="built_in">j</span>,jx0);</span><br><span class="line"></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   use Descent Method with Trust Region. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[min,x]</span> = <span class="title">DescentMethodTrustRegion</span><span class="params">(f,x0)</span></span></span><br><span class="line"><span class="comment">%	min为输出的最小值，x为达到最小值的位置。</span></span><br><span class="line"><span class="comment">%   f为传入的函数，x0为起始的点（可多维）。</span></span><br><span class="line">k=<span class="number">0</span>;    <span class="comment">%跑有限次算法</span></span><br><span class="line">x=x0;   <span class="comment">%传入起点</span></span><br><span class="line">delta=<span class="number">0.1</span>*norm(first_order_derivative(f,x));    <span class="comment">%求梯度的模</span></span><br><span class="line">found=<span class="built_in">false</span>;</span><br><span class="line">k_max=<span class="number">10000</span>;  <span class="comment">%一共跑k_max次算法</span></span><br><span class="line"><span class="keyword">while</span> ~found &amp;&amp; k&lt;=k_max</span><br><span class="line">    k=k+<span class="number">1</span>;</span><br><span class="line">    derivative=first_order_derivative(f,x);     <span class="comment">%在每次更新过x后重新计算梯度。</span></span><br><span class="line">    htr=-derivative/norm(derivative)*delta;   <span class="comment">%除以norm得到方向，乘以delta得到长度。</span></span><br><span class="line">    qh=compute(f,x)+htr*first_order_derivative(f,x)&#x27;;</span><br><span class="line">    r=(compute(f,x)-compute(f,x+htr))/(compute(f,x)-qh);    <span class="comment">%q0,即不加上htr，仅有x</span></span><br><span class="line">    <span class="keyword">if</span> r&gt;<span class="number">0.75</span>               <span class="comment">%到了信赖半径的边缘，扩大</span></span><br><span class="line">        delta = <span class="number">2</span>*delta;                </span><br><span class="line">    <span class="keyword">elseif</span> r&lt;<span class="number">0.25</span>           <span class="comment">%步子太大，缩小，重新走。</span></span><br><span class="line">        delta = delta/<span class="number">3</span>;    </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> r&gt;<span class="number">0</span>      <span class="comment">%说明方向对了，继续走</span></span><br><span class="line">        x = x+htr;      <span class="comment">%更新x</span></span><br><span class="line">        <span class="built_in">min</span> = compute(f,x);   <span class="comment">%计算最小值，用于函数返回，跑够次数，则将min返回。</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    d = norm(first_order_derivative(f,x));    <span class="comment">%计算梯度值得范数（模）</span></span><br><span class="line">    <span class="keyword">if</span> d&lt;=<span class="number">10</span>^<span class="number">-6</span>     <span class="comment">%当模小于...则找到。</span></span><br><span class="line">        found = <span class="built_in">true</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   get first order derivative of Descent Method with Trust Region. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">d</span> = <span class="title">first_order_derivative</span><span class="params">(f,x)</span></span></span><br><span class="line"><span class="comment">%   计算一阶导数</span></span><br><span class="line">len = <span class="built_in">length</span>(x);</span><br><span class="line">d = <span class="built_in">zeros</span>(<span class="number">1</span>,len);</span><br><span class="line">dx=<span class="number">10</span>^<span class="number">-9</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:len</span><br><span class="line">    xi_new = x;</span><br><span class="line">    xi_new(<span class="built_in">i</span>) = x(<span class="built_in">i</span>)+dx;</span><br><span class="line">    v_new = compute(f,xi_new);</span><br><span class="line">    d(<span class="built_in">i</span>) = (v_new-compute(f,x))/(dx);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: 4 %</span></span><br><span class="line"><span class="comment">% Date:(2019.9.23) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) % % %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(4.3) %</span></span><br><span class="line"><span class="comment">% Description:   compute the value of f when x=x. %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">value</span> = <span class="title">compute</span><span class="params">(f,x)</span></span></span><br><span class="line"><span class="comment">%   由于存在多个变量的函数，因此计算值时，x有多个值传入，需要将其去掉括号一起传入。</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">s(<span class="number">1</span>:<span class="number">8</span>) = <span class="string">&#x27;feval(f,&#x27;</span>;    <span class="comment">%由于f在本函数中为传入的参量，在因此最后调用eval执行的是</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(x)<span class="number">-1</span>   <span class="comment">% feval(f,x1,x2,x3.....)。此时f会被真实的函数替代。</span></span><br><span class="line">    s = [s,num2str(x(<span class="built_in">i</span>),<span class="string">&#x27;%10.9e\n&#x27;</span>),<span class="string">&#x27;,&#x27;</span>];   <span class="comment">%将x1,x2,x3....一个个传入</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">s = [s,num2str(x(<span class="keyword">end</span>),<span class="string">&#x27;%10.9e\n&#x27;</span>),<span class="string">&#x27;)&#x27;</span>];     <span class="comment">%传入最后一个数据</span></span><br><span class="line">value = eval(s);            <span class="comment">%计算</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Attach the parts above to a Word document and the results should be shown below.</span></span><br></pre></td></tr></table></figure>

<h2 id="Exercise-Optimization-Based-Sampling-Algorithm"><a href="#Exercise-Optimization-Based-Sampling-Algorithm" class="headerlink" title="Exercise: Optimization-Based Sampling Algorithm"></a>Exercise: Optimization-Based Sampling Algorithm</h2><p>Implement the procedure for improving uniformity of sample distribution generated  by LHS algorithm. Use fmincon routine from Matlab Optimization Toolbox to  directly minimize the uniformity measure with location of the sample points as  design variables.</p>
<p>Use your procedure to generate N points in n-dimensional design space [l1 u1 ] * [l2 u2 ] * … * [ln un ]. Compare the quality of initial and optimized distribution using  both graphical visualization and the uniformity measure implemented in Exercise 1.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line"><span class="comment">% Course: Nonlinear Optimization. %</span></span><br><span class="line"><span class="comment">% FALL.2019. Dr. Cheng. %</span></span><br><span class="line"><span class="comment">% Assignment: (10) %</span></span><br><span class="line"><span class="comment">% Date:(2016.11.8) %</span></span><br><span class="line"><span class="comment">% By: (许维杰) %</span></span><br><span class="line"><span class="comment">% %</span></span><br><span class="line"><span class="comment">% ID NUMBER: (11930535) %</span></span><br><span class="line"><span class="comment">% LAB:(10.3) %</span></span><br><span class="line"><span class="comment">% Description: Optimization-Based Sampling Algorithm %</span></span><br><span class="line"><span class="comment">% all inputs. %</span></span><br><span class="line"><span class="comment">%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%</span></span><br><span class="line">clear;close;</span><br><span class="line">n = <span class="number">2</span>;</span><br><span class="line">N = <span class="number">50</span>;</span><br><span class="line">lb = [<span class="number">0</span>;<span class="number">0</span>].*<span class="built_in">zeros</span>(n,N);</span><br><span class="line">ub = [<span class="number">10</span>;<span class="number">10</span>].*<span class="built_in">ones</span>(n,N);</span><br><span class="line">s = Latin_hypercube_sampling(n,N,lb,ub);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>);</span><br><span class="line">draw(s,[<span class="number">1</span>,<span class="number">2</span>],lb,ub);</span><br><span class="line">title(<span class="string">&#x27;initial samples&#x27;</span>);</span><br><span class="line">u0 = uniformity_cal(s);</span><br><span class="line">options = optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;iter&#x27;</span>,<span class="string">&#x27;TolFun&#x27;</span>,<span class="number">1e-15</span>);</span><br><span class="line">[sf, uf] = fmincon(@uniformity_cal,s,[],[],[],[],lb,ub);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line">draw(sf,[<span class="number">1</span>,<span class="number">2</span>],lb,ub);</span><br><span class="line">title(<span class="string">&#x27;optimized samples&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">s</span> = <span class="title">Latin_hypercube_sampling</span><span class="params">(n,N,lb,ub)</span></span></span><br><span class="line">    delta = (ub-lb)/N;</span><br><span class="line">    bin = <span class="built_in">zeros</span>(n,N);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:n</span><br><span class="line">        bin(<span class="built_in">i</span>,:) = randperm(N)<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    s = delta.*(<span class="built_in">rand</span>(n,N)+bin);</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span><span class="params">(S,sub_space,lb,ub)</span></span></span><br><span class="line">        [n,N] = <span class="built_in">size</span>(S);</span><br><span class="line">        <span class="built_in">plot</span>(S(sub_space(<span class="number">1</span>),<span class="number">1</span>),S(sub_space(<span class="number">2</span>),<span class="number">1</span>),<span class="string">&#x27;ro&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">2</span>:N</span><br><span class="line">        <span class="built_in">plot</span>(S(sub_space(<span class="number">1</span>),<span class="built_in">i</span>),S(sub_space(<span class="number">2</span>),<span class="built_in">i</span>),<span class="string">&#x27;ro&#x27;</span>,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">        <span class="built_in">hold</span> off;</span><br><span class="line">        grid on;</span><br><span class="line">        axis equal;</span><br><span class="line">        axis([lb(sub_space(<span class="number">1</span>)),ub(sub_space(<span class="number">1</span>)),lb(sub_space(<span class="number">2</span>)),ub(sub_space(<span class="number">2</span>))]);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniformity</span> = <span class="title">uniformity_cal</span><span class="params">(S)</span></span></span><br><span class="line">    [n,N] = <span class="built_in">size</span>(S);</span><br><span class="line">    uniformity = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:N</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span> = <span class="built_in">i</span>+<span class="number">1</span>:N</span><br><span class="line">            uniformity = uniformity+<span class="number">1</span>/sum((S(:,<span class="built_in">i</span>)-S(:,<span class="built_in">j</span>)).^<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502150511302.png" class title="image-20210502150511302">

<h2 id="Final-Report-Artificial-Bee-Colony-Algorithm-for-TSP"><a href="#Final-Report-Artificial-Bee-Colony-Algorithm-for-TSP" class="headerlink" title="Final Report: Artificial Bee Colony Algorithm for TSP"></a>Final Report: Artificial Bee Colony Algorithm for TSP</h2><p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/wilsonxu7/wilsonxu7.github.io/612064182873116d689a44c93b6f558964281e40/download/Artificial%20Bee%20Colony%20Algorithm%20for%20TSP.pdf">下载报告</a></p>
<p>Basic steps of the ABC algorithm are given below:</p>
<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502151456421.png" alt="image-20210502151456421">

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502154843857.png" class title="image-20210502154843857">

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502154922385.png" class title="image-20210502154922385">

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502155104654.png" class title="image-20210502155104654">

<img src="/2021/05/02/%E9%AB%98%E7%BA%A7%E9%9D%9E%E7%BA%BF%E6%80%A7%E4%BC%98%E5%8C%96/image-20210502155222840.png" class title="image-20210502155222840">
























      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wilson Xu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wilson's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/" class="post-title-link" itemprop="url">【33】散斑图像比对</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2020-06-20 15:16:13" itemprop="dateCreated datePublished" datetime="2020-06-20T15:16:13+08:00">2020-06-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2021-05-02 14:02:53" itemprop="dateModified" datetime="2021-05-02T14:02:53+08:00">2021-05-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="散斑图像比对是这么搞的"><a href="#散斑图像比对是这么搞的" class="headerlink" title="散斑图像比对是这么搞的"></a>散斑图像比对是这么搞的</h1><h2 id="首先来搞清楚怎么采集的数据。"><a href="#首先来搞清楚怎么采集的数据。" class="headerlink" title="首先来搞清楚怎么采集的数据。"></a>首先来搞清楚怎么采集的数据。</h2><ul>
<li>采集方法简化版如下图所示。</li>
</ul>
<img src="/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/01.png" class title="采集数据示意图">

<ul>
<li>激光器发出可调波长的激光，在光纤另一端固定位置放置CCD相机，拍摄散斑图像。</li>
<li>每次调整波长改变0.1nm，拍摄图像，存储数据。</li>
<li>下图是两张delta波长=0.1nm的散斑图像。非常相似。<table>
  <tr>
      <td><center><img src="/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/a.png">图1  散斑图像1 </center></td>
      <td><center><img src="/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/b.png">图2 散斑图像2 </center></td>
  </tr>
</table></li>
</ul>
<h2 id="光纤散斑图像比对"><a href="#光纤散斑图像比对" class="headerlink" title="光纤散斑图像比对"></a>光纤散斑图像比对</h2><h3 id="直接进行相关性分析"><a href="#直接进行相关性分析" class="headerlink" title="直接进行相关性分析"></a>直接进行相关性分析</h3><ul>
<li>主要使用MATLAB的corr2函数，计算两两图片之间的相关性。</li>
</ul>
<details>
  <summary>Matlab代码</summary>
  
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">close all;</span><br><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line"><span class="comment">%有好的素质三连</span></span><br><span class="line"></span><br><span class="line">Pic_num=<span class="number">509</span>; <span class="comment">% 共有509张图片</span></span><br><span class="line">R=<span class="built_in">zeros</span>(Pic_num,Pic_num);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:Pic_num</span><br><span class="line">    s=strcat(<span class="string">&#x27;picture (&#x27;</span>,num2str(<span class="built_in">i</span>),<span class="string">&#x27;).png&#x27;</span>);</span><br><span class="line">    img_a=rgb2gray(imread(s));</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:<span class="number">1</span>:Pic_num</span><br><span class="line">        s=strcat(<span class="string">&#x27;picture (&#x27;</span>,num2str(<span class="built_in">j</span>),<span class="string">&#x27;).png&#x27;</span>);</span><br><span class="line">        img_b=rgb2gray(imread(s));</span><br><span class="line">        R(<span class="built_in">i</span>,<span class="built_in">j</span>)=corr2(img_a,img_b);</span><br><span class="line">        R(<span class="built_in">j</span>,<span class="built_in">i</span>)=R(<span class="built_in">i</span>,<span class="built_in">j</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% R(find(R==0))= NaN;</span></span><br><span class="line"><span class="comment">% R(find(R==1))= NaN;</span></span><br><span class="line">save(<span class="string">&#x27;R.mat&#x27;</span>,<span class="string">&#x27;R&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%绘制 类混淆矩阵</span></span><br><span class="line">imagesc(R);</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>得到结果如图所示。黄色为相关性最高的1。可以再斜对角线周围看到明显的淡黄色光晕。即相近波长，在同一位置的散斑图像相关性要高一些。</li>
</ul>
<img src="/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/02.png" class title="相关性计算结果">

<ul>
<li>在200处看到有类似比较明显的错误，但经过原始数据比对，并非图像存储出现了问题，而是在被误判的几张图市场相近。</li>
</ul>
<h3 id="计算汉明距离"><a href="#计算汉明距离" class="headerlink" title="计算汉明距离"></a>计算汉明距离</h3><ul>
<li>使用Python</li>
</ul>
<details>
  <summary>汉明距离相似度计算dHash.py</summary>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Author:  zuowei</span></span><br><span class="line"><span class="comment"># CreateDate: 2020-6-9</span></span><br><span class="line"><span class="comment"># function: 实现dHash算法：产生dHash编码，利用汉明距离进行相似度计算</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="comment"># hitz的左大佬提供了代码，保护！</span></span><br></pre></td></tr></table></figure>
</details>
<details>
    <summary>汉明距离-主函数match.py</summary>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dHash <span class="keyword">import</span> DHash</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    DHsh = DHash()</span><br><span class="line">    Pic_num = <span class="number">509</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Pic_num):</span><br><span class="line">        pth = <span class="string">&quot;D:\\wavelengths\\atest\\picture (&quot;</span> + <span class="built_in">str</span>(i+<span class="number">1</span>) + <span class="string">&quot;).png&quot;</span></span><br><span class="line">        image_a = Image.<span class="built_in">open</span>(pth).convert(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(Pic_num):</span><br><span class="line">            pth = <span class="string">&quot;D:\\wavelengths\\atest\\picture (&quot;</span> + <span class="built_in">str</span>(j+<span class="number">1</span>) + <span class="string">&quot;).png&quot;</span></span><br><span class="line">            image_b = Image.<span class="built_in">open</span>(pth).convert(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">            hamming_distance = DHash.hamming_distance(</span><br><span class="line">                first=image_a, second=image_b)</span><br><span class="line">            R[i, j] = hamming_distance</span><br><span class="line"><span class="comment">#    print(R)</span></span><br><span class="line">    np.savetxt(<span class="string">&quot;AAAA&quot;</span>, R)</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>得到结果如图所示，效果并不好，甚至没有最简单的相关性计算的结果好。</li>
</ul>
<img src="/2020/06/20/%E6%95%A3%E6%96%91%E5%9B%BE%E5%83%8F%E6%AF%94%E5%AF%B9/03.png" class title="哈明距离结果">
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wilson Xu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wilson's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/" class="post-title-link" itemprop="url">【1】压缩感知</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2020-06-17 15:16:13" itemprop="dateCreated datePublished" datetime="2020-06-17T15:16:13+08:00">2020-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2021-04-30 18:48:26" itemprop="dateModified" datetime="2021-04-30T18:48:26+08:00">2021-04-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="压缩感知"><a href="#压缩感知" class="headerlink" title="压缩感知"></a>压缩感知</h1><ul>
<li>内容来自于知乎学习<blockquote>
<p>这个作者写的很好，之前和他学习过小波变换。<br>原文链接<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/22445302">形象易懂讲解算法II——压缩感知</a></p>
</blockquote>
</li>
<li>代码的参考来源来自<a target="_blank" rel="noopener" href="https://github.com/harrydragon/MATLAB/tree/master/MN/LAB2">Github-harrydragon</a></li>
<li><em>突破了</em>信号处理领域的金科玉律——<em>奈奎斯特采样定律</em>。即，在信号采样的过程中，用很少的采样点，实现了和全采样一样的效果。</li>
</ul>
<h2 id="前提条件1：稀疏性（sparsity）"><a href="#前提条件1：稀疏性（sparsity）" class="headerlink" title="前提条件1：稀疏性（sparsity）"></a>前提条件1：稀疏性（sparsity）</h2><ul>
<li><p>若信号在某个域中只有少量非零值，那么它在该域稀疏，该域也被称为信号的稀疏域。</p>
</li>
<li><p>然而通常信号在变换域中不会呈现完全的稀疏性。其实只要它近似满足稀疏性，即大部分值趋于零，只有少量大的非零值，就可以认为它是可压缩信号，可以对它进行CS亚采样。</p>
</li>
<li><p>对于之前讲的例子，如果它在频域中不稀疏，我们可以做DWT、DCT等，找到它的稀疏变换。</p>
<blockquote>
<p>DWT （Discrete Wavelet Transformation） 离散小波变换<br>DCT （Discrete Cosine Transform） 离散余弦变换\</p>
</blockquote>
<blockquote>
<p>稀疏性普遍用作图像压缩，eg.JPEG<br>将图像的数据转到稀疏的域，留下主成分，将其余置零。</p>
</blockquote>
<blockquote>
<p>图像压缩 与 压缩感知的区别：</p>
<blockquote>
<p>图像压缩：全采样，再压缩。<br>压缩感知：亚采样，用算法消除亚采样的伪影。<br>压缩感知在采样时候，完成的压缩。</p>
</blockquote>
</blockquote>
</li>
</ul>
<h2 id="压缩感知-1"><a href="#压缩感知-1" class="headerlink" title="压缩感知"></a>压缩感知</h2><center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image1.png">信号频谱</center>


<ul>
<li><p>如图，x是为长度N的一维信号，也就是原信号，稀疏度为k。此刻它是未知的。</p>
</li>
<li><p>Φ为观测矩阵，对应着亚采样这一过程。它将高维信号x投影到低维空间，是已知的。</p>
</li>
<li><p>y=Φx为长度M的一维测量值，也就是亚采样后的结果。显然它也是已知的。</p>
</li>
<li><p>因此，压缩感知问题就是在已知测量值y和测量矩阵Φ的基础上，求解欠定方程组y=Φx得到原信号x。</p>
</li>
<li><p>然而，一般的自然信号x本身并不是稀疏的，需要在某种稀疏基上进行稀疏表示。令x=Ψs，Ψ为稀疏基矩阵，s为稀疏系数。</p>
</li>
<li><p>于是最终方程就变成了：y=ΦΨs。已知y、Φ、Ψ，求解s。</p>
</li>
</ul>
<center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image2.png">信号频谱</center>

<ul>
<li> y=ΦΨs有点长，我们把ΦΨ合并成一个矩阵，称之为传感矩阵。即令Θ=ΦΨ<br>，则y=ΘS。</li>
<li>问题即为，已知y和Θ，求解S。求解出S后，由x=Ψs即可得到恢复出的原信号x。</li>
<li>然而在正常情况下，方程的个数远小于未知数的个数，方程是没有确定解的，无法重构信号。但是，由于信号是K稀疏，如果上式中的Φ满足有限等距性质(RIP)，则K个系数就能够从M个测量值准确重构（得到一个最优解）。</li>
</ul>
<h2 id="前提条件2：不相关性（incoherence）"><a href="#前提条件2：不相关性（incoherence）" class="headerlink" title="前提条件2：不相关性（incoherence）"></a>前提条件2：不相关性（incoherence）</h2><table>
    <tr>
        <td><center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image3.png"> </center></td>
        <td><center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image4.png"> </center></td>
    </tr>
</table>

<ul>
<li>陶哲轩和Candès大神证明了RIP才是观测矩阵要满足的准确要求。但是，要确认一个矩阵是否满足RIP非常复杂。于是Baraniuk证明：RIP的等价条件是观测矩阵和稀疏表示基不相关（incoherent）。 </li>
</ul>
<center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image5.png">信号频谱</center>

<ul>
<li><p>那怎样找到不相关的观测矩阵呢？陶哲轩和Candès又证明： <strong>独立同分布的高斯随机测量矩阵可以成为普适的压缩感知测量矩阵。</strong></p>
</li>
<li><p>于是满足高斯分布的随机测量矩阵就成了CS最常用的观测矩阵。</p>
</li>
<li><p>对于二维信号，往往就采用如右上图所示的采样矩阵对图像进行亚采样。</p>
</li>
<li><p>对于一维信号，采用前文提到的随机不等间距的亚采样即可。</p>
</li>
</ul>
<h2 id="概括总结"><a href="#概括总结" class="headerlink" title="概括总结"></a>概括总结</h2><ul>
<li><p>如果一个信号在<strong>某个变换域是稀疏的</strong>，那么就可以用一个<strong>与变换基不相关的观测矩阵</strong>将变换所得高维信号投影到一个低维空间上，然后通过<strong>求解一个优化问题</strong>就可以从这些少量的投影中以高概率重构出原信号。</p>
</li>
<li><p>之前图像压缩的方法是全采样之后再压缩，抛弃稀疏变换域中的一些小系数；而CS直接减少了采样点，采集完后、经过重建的图像，就是一副在某变换域稀疏的压缩图像，比如JPEG。</p>
</li>
<li><p>优势：</p>
<blockquote>
<p>对于很多情形，比如照相机拍摄照片，这样减少采样点并没有优势。因为所有像素的采集在一瞬间就都完成了。<br>但是对于一些采集比较慢的情形，比如核磁共振成像，CS就可以发挥巨大优势。原本一副MRI图像常常需要几十秒，速度慢也是MRI的一大缺陷。而应用CS技术后，只需要采集全采样几分之一的数据，就可以重建出原图。这样就可以把成像速度提高好几倍，同时对图像质量影响不大。<br>另一个应用是Rice大学开发的单像素相机，也就是说这种相机只需要一个像素，非常有趣。感兴趣的朋友可以自己去调查。</p>
</blockquote>
</li>
</ul>
<h2 id="算法理解"><a href="#算法理解" class="headerlink" title="算法理解"></a>算法理解</h2><center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image6.png">信号频谱</center>

<p>公式：<br>$$ y=\phi x $$</p>
<ul>
<li>其中 $x$为 $N \times 1$的矩阵，eg.一个信号长度为$512 \times 1$</li>
<li>在这一个列向量中，有K个非零量，K远小于N，其他的近似于零。因此信号 $x$ 稀疏。<blockquote>
<p>如果是一个二维数组，则可以按照列，将其排列成列向量。（？）</p>
</blockquote>
</li>
</ul>
<p>创造一个大小为 $M\times N$的测量矩阵。该矩阵可以为</p>
<ul>
<li><details>
  <summary>(1) 随机高斯测量矩阵</summary>

  <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ Phi ]</span> = <span class="title">GaussMtx</span><span class="params">( M,N )</span></span></span><br><span class="line"><span class="comment">%GaussMtx Summary of this function goes here</span></span><br><span class="line"><span class="comment">%   Generate Bernoulli matrix </span></span><br><span class="line"><span class="comment">%   M -- RowNumber</span></span><br><span class="line"><span class="comment">%   N -- ColumnNumber</span></span><br><span class="line"><span class="comment">%   Phi -- The Gauss matrix</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Generate Gauss matrix   </span></span><br><span class="line">    Phi = <span class="built_in">randn</span>(M,N);</span><br><span class="line">    <span class="comment">%Phi = Phi/sqrt(M);</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</details></li>
<li><details>
  <summary>(2) 随机贝努力测量矩阵</summary>

  <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ Phi ]</span> = <span class="title">BernoulliMtx</span><span class="params">( M,N )</span></span></span><br><span class="line"><span class="comment">%BernoulliMtx Summary of this function goes here</span></span><br><span class="line"><span class="comment">%   Generate Bernoulli matrix </span></span><br><span class="line"><span class="comment">%   M -- RowNumber</span></span><br><span class="line"><span class="comment">%   N -- ColumnNumber</span></span><br><span class="line"><span class="comment">%   Phi -- The Bernoulli matrix</span></span><br><span class="line"><span class="comment">%% (1)Generate Bernoulli matrix(The first kind)</span></span><br><span class="line"><span class="comment">% 1--P=0.5   -1--P=0.5</span></span><br><span class="line">    Phi = randi([<span class="number">0</span>,<span class="number">1</span>],M,N);<span class="comment">%If your MATLAB version is too low,please use randint instead</span></span><br><span class="line">    Phi(Phi==<span class="number">0</span>) = <span class="number">-1</span>;</span><br><span class="line"><span class="comment">%Phi = Phi/sqrt(M);</span></span><br><span class="line"><span class="comment">% %% (2)Generate Bernoulli matrix(The second kind)</span></span><br><span class="line"><span class="comment">% % 1--P=1/6   -1--P=1/6  0--2/3</span></span><br><span class="line"><span class="comment">%     Phi = randi([-1,4],M,N);%If your MATLAB version is too low,please use randint instead</span></span><br><span class="line"><span class="comment">%     Phi(Phi==2) = 0;%P=1/6</span></span><br><span class="line"><span class="comment">%     Phi(Phi==3) = 0;%P=1/6</span></span><br><span class="line"><span class="comment">%     Phi(Phi==4) = 0;%P=1/6</span></span><br><span class="line"><span class="comment">%     %Phi = Phi*sqrt(3/M);</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</details></li>
<li><details>
  <summary>(3) 部分哈达玛测量矩阵</summary>

  <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ Phi ]</span> = <span class="title">PartHadamardMtx</span><span class="params">( M,N )</span></span></span><br><span class="line"><span class="comment">%PartHadamardMtx Summary of this function goes here</span></span><br><span class="line"><span class="comment">%   Generate part Hadamard matrix </span></span><br><span class="line"><span class="comment">%   M -- RowNumber</span></span><br><span class="line"><span class="comment">%   N -- ColumnNumber</span></span><br><span class="line"><span class="comment">%   Phi -- The part Hadamard matrix</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% parameter initialization</span></span><br><span class="line"><span class="comment">%Because the MATLAB function hadamard handles only the cases where n, n/12,</span></span><br><span class="line"><span class="comment">%or n/20 is a power of 2</span></span><br><span class="line">    L_t = <span class="built_in">max</span>(M,N);<span class="comment">%Maybe L_t does not meet requirement of function hadamard</span></span><br><span class="line">    L_t1 = (<span class="number">12</span> - <span class="built_in">mod</span>(L_t,<span class="number">12</span>)) + L_t;</span><br><span class="line">    L_t2 = (<span class="number">20</span> - <span class="built_in">mod</span>(L_t,<span class="number">20</span>)) + L_t; </span><br><span class="line">    L_t3 = <span class="number">2</span>^<span class="built_in">ceil</span>(<span class="built_in">log2</span>(L_t));</span><br><span class="line">    L = <span class="built_in">min</span>([L_t1,L_t2,L_t3]);<span class="comment">%Get the minimum L</span></span><br><span class="line"><span class="comment">%% Generate part Hadamard matrix   </span></span><br><span class="line">    Phi = [];</span><br><span class="line">    Phi_t = <span class="built_in">hadamard</span>(L);</span><br><span class="line">    RowIndex = randperm(L);</span><br><span class="line">    Phi_t_r = Phi_t(RowIndex(<span class="number">1</span>:M),:);</span><br><span class="line">    ColIndex = randperm(L);</span><br><span class="line">    Phi = Phi_t_r(:,ColIndex(<span class="number">1</span>:N));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</details></li>
<li><details>
  <summary>(4) 部分傅里叶测量矩阵</summary>
  
  <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ Phi ]</span> = <span class="title">PartFourierMtx</span><span class="params">( M,N )</span></span></span><br><span class="line"><span class="comment">%PartFourierMtx Summary of this function goes here</span></span><br><span class="line"><span class="comment">%   Generate part Fourier matrix </span></span><br><span class="line"><span class="comment">%   M -- RowNumber</span></span><br><span class="line"><span class="comment">%   N -- ColumnNumber</span></span><br><span class="line"><span class="comment">%   Phi -- The part Fourier matrix</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Generate part Fourier matrix   </span></span><br><span class="line">    Phi_t = fft(<span class="built_in">eye</span>(N,N))/<span class="built_in">sqrt</span>(N);<span class="comment">%Fourier matrix</span></span><br><span class="line">    RowIndex = randperm(N);</span><br><span class="line">    Phi = Phi_t(RowIndex(<span class="number">1</span>:M),:);<span class="comment">%Select M rows randomly</span></span><br><span class="line">    <span class="comment">%normalization</span></span><br><span class="line">    <span class="keyword">for</span> ii = <span class="number">1</span>:N</span><br><span class="line">        Phi(:,ii) = Phi(:,ii)/norm(Phi(:,ii));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</details></li>
<li><details>
  <summary>(5) 稀疏随机测量矩阵</summary>

  <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[ Phi ]</span> = <span class="title">SparseRandomMtx</span><span class="params">( M,N,d )</span></span></span><br><span class="line"><span class="comment">%SparseRandomMtx Summary of this function goes here</span></span><br><span class="line"><span class="comment">%   Generate SparseRandom matrix </span></span><br><span class="line"><span class="comment">%   M -- RowNumber</span></span><br><span class="line"><span class="comment">%   N -- ColumnNumber</span></span><br><span class="line"><span class="comment">%   d -- The number of &#x27;1&#x27; in every column,d&lt;M </span></span><br><span class="line"><span class="comment">%   Phi -- The SparseRandom matrix</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Generate SparseRandom matrix   </span></span><br><span class="line">    Phi = <span class="built_in">zeros</span>(M,N);</span><br><span class="line">    <span class="keyword">for</span> ii = <span class="number">1</span>:N</span><br><span class="line">        ColIdx = randperm(M);</span><br><span class="line">        Phi(ColIdx(<span class="number">1</span>:d),ii) = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</details></li>
</ul>
<ul>
<li>最终得到 $y$就是压缩后的信号。</li>
<li>从 $y$ 和 $\phi$ 恢复出 $x$，就是恢复算法。</li>
</ul>
<p>$$M=O(K \log(N/K)) $$<br>$M$为测量矩阵$\phi$大小的选择。在这里如何取值，<strong>没有看明白。</strong></p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>针对于<br>$$ f=\cos{\frac{2\pi t}{256}} + \sin{\frac{2\pi t}{128}}$$<br>这一个信号，它的频谱为：</p>
<center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image7.png">信号频谱</center>
在频域上，可以认为这个信号稀疏，因此可以进行压缩感知。\
代码如下:

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% 素质三连</span></span><br><span class="line">clc; clear all; close all</span><br><span class="line"><span class="comment">%% 初始化信号</span></span><br><span class="line">n = <span class="number">512</span>; <span class="comment">% Signal length</span></span><br><span class="line">s = <span class="number">2</span> ; <span class="comment">% Sparsity level</span></span><br><span class="line">m = <span class="number">40</span> ；<span class="comment">%1 + floor((s+1)*log10(n)); % Number of measurements</span></span><br><span class="line">fs=<span class="number">0.04</span>; <span class="comment">% 用于fft看频域%  t = [0:n-1]&#x27;/fs;</span></span><br><span class="line">t = [<span class="number">0</span>:n<span class="number">-1</span>]&#x27;;</span><br><span class="line">f = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>/<span class="number">256</span>*t) + <span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>/<span class="number">128</span>*t);</span><br><span class="line">fft_f=fft(f,n); <span class="comment">% 得到频域的稀疏信号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% 多种传感矩阵</span></span><br><span class="line">A1 = get_A_random(n ,m);</span><br><span class="line">A2 = get_A_fourier(n ,m);</span><br><span class="line">A3 = PartHadamardMtx(n,m);</span><br><span class="line"></span><br><span class="line">A=A3; <span class="comment">% 选择一种传感矩阵</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% y=phi*x</span></span><br><span class="line">y =A*fft_f; <span class="comment">% Take the measurements</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Solve using CVX. 用CVX工具解优化</span></span><br><span class="line">cvx_begin</span><br><span class="line">    variable xp(n) <span class="built_in">complex</span>;</span><br><span class="line">    minimize(norm(xp,<span class="number">1</span>)) ;</span><br><span class="line">    subject to</span><br><span class="line">    A*xp == y </span><br><span class="line">cvx_end</span><br><span class="line"></span><br><span class="line">temp=norm(fft_f-xp)/norm(fft_f);</span><br><span class="line"><span class="comment">%% 逆傅里叶变换，回到时域</span></span><br><span class="line">ifft_signal=ifft(xp,n);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">plot</span> ( f )</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="comment">%subplot(2,1,2);</span></span><br><span class="line"><span class="built_in">plot</span> ( <span class="built_in">real</span>(ifft_signal) ,<span class="string">&#x27;r.&#x27;</span> ) <span class="comment">% 选取实部作图（虚部有极小的分量。）</span></span><br><span class="line"><span class="built_in">legend</span> ( <span class="string">&#x27; Original &#x27;</span> , <span class="string">&#x27; Recovered &#x27;</span> )</span><br></pre></td></tr></table></figure>
<table>
    <tr>
        <td><center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image8.png">时域信号 </center></td>
        <td><center><img src="/2020/06/17/%E5%8E%8B%E7%BC%A9%E6%84%9F%E7%9F%A5/image9.png">频域信号（代码需另写） </center></td>
    </tr>
</table>

<h1 id="接下来将更新一些关于硬件上的压缩感知实现。"><a href="#接下来将更新一些关于硬件上的压缩感知实现。" class="headerlink" title="接下来将更新一些关于硬件上的压缩感知实现。"></a>接下来将更新一些关于硬件上的压缩感知实现。</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Inhaltsverzeichnis
        </li>
        <li class="sidebar-nav-overview">
          Übersicht
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Wilson Xu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">Artikel</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">schlagwörter</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wilson Xu</span>
</div>
  <div class="powered-by">Erstellt mit  <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
